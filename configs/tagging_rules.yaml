# configs/tagging_rules.yaml
# v0.1.2 draft – rule-based 분류/태깅 고도화

# 1) 섹션 판별 신호어 (정규식 허용, OR 매칭)
section_signals:
  summary:
    - "(증상|현상|장애|오류|에러|로그|발생|환경|버전)"
    - "(접속 불가|인증 실패|느려짐|타임아웃)"
    - "(구성|설정|사양|Topology|구축|배포)"
  root_cause:
    - "(원인|근본 원인|분석|재현)"
    - "(policy|정책|세션|timeout|drop|deny|blocked|misconfig)"
    - "(DNS|DHCP|ARP|MTU|VLAN|NAT|TLS|SSL|cert|CA|CRL|OCSP)"
  actions:
    - "(조치|해결|수정|변경|적용|재기동|재시작|Rollback)"
    - "(명령어|스크립트|쿼리|설정값|파라미터|튜닝)"
    - "(systemctl|service|msiexec|mysql|kubectl|helm|curl|openssl)"
  prevention:
    - "(재발 방지|SOP|가이드|운영 기준|정책)"
    - "(모니터링|알람|경보|임계치|threshold|watchdog)"
    - "(점검 주기|백업|DR|이중화|테스트 시나리오)"

# 빈 섹션 제거 최소 글자수
min_section_len: 20

# 2) 카테고리(대분류) – 파일명/본문 정규식 매칭
categories:
  - "NAC"
  - "EDR"
  - "ZTNA"
  - "Network"
  - "Ubuntu"
  - "Linux"
  - "Windows"
  - "VM"
  - "Elasticsearch"
  - "Database"
  - "Cloud"
  - "Security"
  - "SRE|Ops|운영"

# 3) 태그(소분류) – 매핑 테이블 (왼쪽 키 = 태그명, 오른쪽 = 매칭 키워드 리스트)
tags:
  NAC:
    - "(?i)\\bNAC\\b|지니안|Genian|센서|인증|Policy|Agent|Probe|Passive"
  EDR:
    - "(?i)\\bEDR\\b|행위 기반|룰|탐지|IOC|격리"
  ZTNA:
    - "(?i)ZTNA|Zero\\s*Trust|Zscaler|Access"
  Network:
    - "Switch|Router|Gateway|Firewall|NAT|ARP|VLAN|MTU|L2|L3|L4|L7"
  Ubuntu:
    - "(?i)Ubuntu|우분투|apt|systemd|journalctl|netplan"
  Linux:
    - "(?i)Linux|CentOS|RHEL|Rocky|kernel|selinux|yum|dnf"
  Windows:
    - "(?i)Windows|레지스트리|서비스|이벤트 뷰어|PowerShell"
  VM:
    - "VM|가상화|ESXi|vSphere|vCenter|Hyper-V|snapshots?"
  Elasticsearch:
    - "(?i)Elasticsearch|Kibana|Logstash|Elastic\\s*Agent|ES\\s*index|Shards?"
  Database:
    - "(?i)MySQL|MariaDB|PostgreSQL|MSSQL|쿼리|인덱스|트랜잭션"
  Cloud:
    - "(?i)AWS|GCP|Azure|Terraform|IAM|S3|EC2|VPC|CloudTrail"
  Security:
    - "(?i)TLS|SSL|인증서|암호화|키 교환|위협|취약점|CVE"
  Ops:
    - "(?i)SRE|Ops|운영|관제|지표|APM|가용성|SLA|SLO|SLI"

# 4) 라우팅 규칙(옵션) – 저장 경로 분기 우선순위 (앞에서부터 우선 적용)
#   ※ main.py는 storage_category를 front matter로만 적고, 실제 디렉토리 라우팅은
#      사용자가 스크립트 후처리로 선택적으로 적용할 수 있도록 느슨하게 유지.
routing:
  - name: "NAC"
    match: "(?i)NAC|Genian|센서|인증"
    storage_category: "NAC"
  - name: "Elasticsearch"
    match: "(?i)Elasticsearch|Kibana|Logstash"
    storage_category: "Elasticsearch"
  - name: "VM"
    match: "(?i)VM|ESXi|vSphere|vCenter"
    storage_category: "VM"
  - name: "Ubuntu"
    match: "(?i)Ubuntu|우분투"
    storage_category: "Ubuntu"
  - name: "Windows"
    match: "(?i)Windows"
    storage_category: "Windows"
  - name: "Network"
    match: "(?i)Switch|Router|Firewall|VLAN|ARP|MTU"
    storage_category: "Network"
  - name: "Security"
    match: "(?i)TLS|SSL|인증서|암호화|CVE"
    storage_category: "Security"
  - name: "Cloud"
    match: "(?i)AWS|GCP|Azure|Terraform"
    storage_category: "Cloud"

# 5) 태그/카테고리 최대 개수 제한 (가독성/노션 속성 폭발 방지)
limits:
  max_tags: 5
  max_categories: 3
